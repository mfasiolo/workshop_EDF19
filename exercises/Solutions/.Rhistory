?sm
library(mgcViz)
?sm
library(knitr)
opts_chunk$set(out.extra='style="display:block; margin: auto"', fig.align="center", tidy=FALSE)
set.seed(424)
x <- runif(200, -1, 1)
dat <- data.frame(y = x^2 + rnorm(1000, 0, 1), x = x, z = runif(200, -1, -1))
fit <- gamV(y ~ s(x) + s(z), data = dat)
head(dat)
set.seed(424)
x <- runif(200, -1, 1)
dat <- data.frame(y = x^2 + rnorm(1000, 0, 1), x = x, z = runif(200, -1, 1))
set.seed(424)
x <- runif(200, -1, 1)
dat <- data.frame(y = x^2 + rnorm(1000, 0, 1), x = x, z = runif(200, -1, 1))
fit <- gamV(y ~ s(x) + s(z), data = dat)
print(plot(fit), page = 1)
print(plot(fit, select = 2), page = 1)
fit <- gamV(y ~ s(x) + s(z), data = dat, select = TRUE)
fit <- gamV(y ~ s(x) + s(z), data = dat, aGam = list(select = TRUE))
print(plot(fit, select = 2), page = 1)
set.seed(424)
n <- 200
x <- runif(n, -1, 1)
dat <- data.frame(y = x^2 + rnorm(n, 0, 1), x = x, z = runif(n, -1, 1))
fit <- gamV(y ~ s(x) + s(z), data = dat)
print(plot(fit, select = 2), page = 1)
fit <- gamV(y ~ s(x) + s(z), data = dat, aGam = list(select = TRUE))
print(plot(fit, select = 2), page = 1)
set.seed(424)
n <- 400
x <- runif(n, -1, 1)
dat <- data.frame(y = x^2 + rnorm(n, 0, 1), x = x, z = runif(n, -1, 1))
fit <- gamV(y ~ s(x) + s(z), data = dat)
print(plot(fit, select = 2), page = 1)
fit <- gamV(y ~ s(x) + s(z), data = dat, aGam = list(select = TRUE))
print(plot(fit, select = 2), page = 1)
set.seed(444)
n <- 400
x <- runif(n, -1, 1)
dat <- data.frame(y = x^2 + rnorm(n, 0, 1), x = x, z = runif(n, -1, 1))
fit <- gamV(y ~ s(x) + s(z), data = dat)
print(plot(fit, select = 2), page = 1)
fit <- gamV(y ~ s(x) + s(z), data = dat, aGam = list(select = TRUE))
print(plot(fit, select = 2), page = 1)
set.seed(42244)
n <- 400
x <- runif(n, -1, 1)
dat <- data.frame(y = x^2 + rnorm(n, 0, 1), x = x, z = runif(n, -1, 1))
fit <- gamV(y ~ s(x) + s(z), data = dat)
print(plot(fit, select = 2), page = 1)
fit <- gamV(y ~ s(x) + s(z), data = dat, aGam = list(select = TRUE))
print(plot(fit, select = 2), page = 1)
set.seed(42244)
n <- 1000
x <- runif(n, -1, 1)
dat <- data.frame(y = x^2 + rnorm(n, 0, 1), x = x, z = runif(n, -1, 1))
fit <- gamV(y ~ s(x) + s(z), data = dat)
print(plot(fit, select = 2), page = 1)
fit <- gamV(y ~ s(x) + s(z), data = dat, aGam = list(select = TRUE))
print(plot(fit, select = 2), page = 1)
set.seed(4244)
n <- 1000
x <- runif(n, -1, 1)
dat <- data.frame(y = x^2 + rnorm(n, 0, 1), x = x, z = runif(n, -1, 1))
fit <- gamV(y ~ s(x) + s(z), data = dat)
print(plot(fit, select = 2), page = 1)
fit <- gamV(y ~ s(x) + s(z), data = dat, aGam = list(select = TRUE))
print(plot(fit, select = 2), page = 1)
set.seed(42424)
n <- 1000
x <- runif(n, -1, 1)
dat <- data.frame(y = x^2 + rnorm(n, 0, 1), x = x, z = runif(n, -1, 1))
fit <- gamV(y ~ s(x) + s(z), data = dat)
print(plot(fit, select = 2), page = 1)
fit <- gamV(y ~ s(x) + s(z), data = dat, aGam = list(select = TRUE))
print(plot(fit, select = 2), page = 1)
?s
setwd("~/Desktop/All/Dropbox/Work/Notes/Slides/qgam/2018_JGI")
load("data/calcium.rda")
setwd("~/Desktop/All/Dropbox/Work/Notes/Slides/qgam/2018_JGI/exercises")
load("data/calcium.rda")
library(mgcViz)
?gridPrint
setwd("~/Desktop/All/Dropbox/Work/Notes/Slides/qgam/2019_EDF_mgcViz/exercises/Solutions")
library(knitr)
opts_chunk$set(out.extra='style="display:block; margin: auto"', fig.align="center", tidy=FALSE)
source(file = "my_settings.R")
library(RhpcBLASctl); blas_set_num_threads(1)
library(mgcViz)
load(paste0(goodLocation, "/data/Ind_elect.rda")) # change this
fit1 <- bamV(load ~ dow + ID + s(instant) + s(temp) + s(day), data = indElec,
aViz = list(nsim = 50))
print(plot(fit1, allTerms = TRUE), pages = 1)
summary(fit1)
pl1 <- check2D(fit1, "ID", "instant") + l_gridCheck2D(bw = c(NA, 1))
pl2 <- check2D(fit1, "ID", "temp") + l_gridCheck2D(bw = c(NA, 1))
pl3 <- check2D(fit1, "ID", "day") + l_gridCheck2D(bw = c(NA, 5))
gridPrint(pl1, pl2, pl3, ncol = 2)
library(knitr)
library(rgl)
opts_chunk$set(out.extra='style="display:block; margin: auto"', fig.align="center", tidy=FALSE)
knit_hooks$set(webgl = hook_webgl)
source(file = "my_settings.R")
library(RhpcBLASctl); blas_set_num_threads(1)
library(mgcViz)
load(paste0(goodLocation, "/data/Larynx.rda")) # change this
load(paste0(goodLocation, "/data/german.polys.rda")) # change this
X <- t(sapply(german.polys,colMeans,na.rm=TRUE))
fit1 <- gamV(Y ~ s(region, k = 200, bs="mrf",xt=list(polys=german.polys)) + offset(log(E)) + s(x, k=20),
family=poisson, data=Larynx, aViz = list(nsim = 50))
fit3 <- gamV(Y~te(X[,1],X[,2],k=c(15, 15))+offset(log(E))+s(x,k=20), family=poisson, data=Larynx)
print(plot(fit3, select = 1), ask = FALSE)
open3d()
mfrow3d(1, 2)
plotRGL(sm(fit2,1), residuals = TRUE)
open3d()
mfrow3d(1, 2)
plotRGL(sm(fit2,1), residuals = TRUE)
fit2 <- gamV(Y~s(X[,1],X[,2],k=200)+offset(log(E))+s(x,k=20), family=poisson, data=Larynx)
print(plot(fit2, select = 1), ask = FALSE)
open3d()
mfrow3d(1, 2)
plotRGL(sm(fit2,1), residuals = TRUE)
next3d()
plotRGL(sm(fit3,1), residuals = TRUE)
library(knitr)
library(rgl)
opts_chunk$set(out.extra='style="display:block; margin: auto"', fig.align="center", tidy=FALSE)
knit_hooks$set(webgl = hook_webgl)
source(file = "my_settings.R")
library(RhpcBLASctl); blas_set_num_threads(1)
library(mgcViz);
load(paste0(goodLocation, "/data/est.rda"))
m1 <- qgamV(RT ~ InfFamSize + Age + LogFrequency + WordLength + Trial,
data=est, qu=0.5)
summary(m1)
pl <- check1D(m1, x = list("Trial", est$Subject)) + l_gridQCheck1D(qu = 0.5)
print(pl, pages = 1)
